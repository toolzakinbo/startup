<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Home</title>
    <link rel="stylesheet" href="index.css">


    <nav>
      <ul>
        <li><a href="index.html">Home</a></li>
      </ul>
  </nav>
</head>

<body>

    <h1>Recipe Review App</h1>

    <div id="tabs">
        <button onclick="openTab('loginTab')">Login</button>
        <br><br>
        <button onclick="openTab('createAccountTab')">Create Account</button><br><br>
    </div>
    
    <!-- Login Tab -->
    <div id="loginTab" class="tab-content">
        <form action="/api/login" method="post" onsubmit="return login()">
            <label for="username">Username:</label><br>
            <input type="text" id="username" name="username" required><br>

            <label for="password">Password:</label><br>
            <input type="password" id="password" name="password" required><br>

            <button type="button" onclick="login()">Login</button>
        </form>
    </div>

    <!-- Create Account Tab -->
    <div id="createAccountTab" class="tab-content" style="display:none;">
        <form action="/api/create" method="post">
            <label for="new-username">Username:</label><br>
            <input type="text" id="new-username" name="new-username" required><br>

            <label for="new-password">Password:</label><br>
            <input type="password" id="new-password" name="new-password" required><br>

            <label for="confirm-password">Re-enter Password:</label><br>
            <input type="password" id="confirm-password" name="confirm-password" required><br>

            <button type="button" onclick="createAccount()">Create Account</button>
        </form>
    </div>
    <script>
        function openTab(tabName) {
            var i, tabContent;
            tabContent = document.getElementsByClassName("tab-content");
            for (i = 0; i < tabContent.length; i++) {
                tabContent[i].style.display = "none";
            }
            document.getElementById(tabName).style.display = "block";
        }

        async function login() {
            const username = document.getElementById('username').value;
            const password = document.getElementById('password').value;
            
            const response = await fetch('/api/login', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({ username, password }),
            });

            const data = await response.json();

            if (response.ok) {
                // Assuming the server-side login validation is successful, redirect to the recipe review page.
                window.location.href = "recipe-review.html";
            } else {
                // Handle login error (display an error message, for example).
                console.error('Login failed:', data.error);
            }
        }

        async function createAccount() {
            const newUsername = document.getElementById('new-username').value;
            const newPassword = document.getElementById('new-password').value;
            const confirmPassword = document.getElementById('confirm-password').value;

            const response = await fetch('/api/create', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({ username: newUsername, password: newPassword }),
            });

            const data = await response.json();

            if (response.ok) {
                // Account creation successful, you may redirect or show a success message
                window.location.href = "recipe-review.html";
                console.log('Account created successfully:', data.message);
            } else {
                // Handle account creation error (display an error message, for example).
                console.error('Account creation failed:', data.error);
            }
        }

    </script> 
    
    <!-- <script>
    const socket = new WebSocket('ws://fakeweb.com/socket');

    socket.addEventListener('message', function (event) {
        document.getElementById('websocket-data').textContent = event.data;
    });
    </script> -->


</body>
<br>
<br>
<footer >
  <a href="https://github.com/toolzakinbo/startup/tree/main">GitHub</a>
</footer>


</html>
